{"ast":null,"code":"var _jsxFileName = \"/home/samuel/Documents/Zuri project/zc_main/zc_frontend/src/components/PluginContent.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useContext, useEffect } from 'react';\nimport { URLContext } from '../contexts/Url';\nimport cheerio from 'cheerio';\nimport styles from '../styles/PluginContent.module.css';\nimport Welcome from './Welcome';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const PluginContent = () => {\n  _s();\n\n  // const pluginUrl = '/apps/default';\n  const state = useContext(URLContext);\n  const [url] = state.url;\n  useEffect(() => {\n    if (!url) return;\n    const elRoot = document.getElementById('zc-plugin-root');\n    const reProtocol = /^https?:\\/\\//;\n    const oURL = new URL(reProtocol.test(url) ? url : 'http://' + url);\n\n    const prefixLink = (url, oURL, mimeType = 'text/html') => {\n      let ret = reProtocol.test(url) ? url : `${oURL.origin}${url}`;\n      return `/proxy?url=${ret}&mimeType=${mimeType}`;\n    };\n\n    axios.get(prefixLink(oURL.toString())).then(res => {\n      const $ = cheerio.load(res.data); // append stylesheet\n\n      $(`link[rel=\"stylesheet\"]`).each(function () {\n        const link = document.createElement('link');\n        Object.keys(this.attribs).forEach(attr => link.setAttribute(attr, this.attribs[attr]));\n        link.setAttribute('href', prefixLink(this.attribs.href, oURL, 'text/css'));\n        link.setAttribute('data-plugin-res', true);\n        $(this).remove();\n        document.head.prepend(link);\n      }); // append scripts\n\n      $('script').each(function () {\n        const script = document.createElement('script');\n        Object.keys(this.attribs).forEach(attr => script.setAttribute(attr, this.attribs[attr]));\n\n        if (script.src) {\n          script.setAttribute('src', prefixLink(this.attribs.src, oURL, 'application/javascript'));\n        } else {\n          script.innerText = $(this).html();\n        }\n\n        $(this).remove();\n        script.setAttribute('data-plugin-res', true);\n        document.body.appendChild(script);\n      });\n      elRoot.innerHTML = $('body').html();\n    }).catch(e => {\n      elRoot.innerHTML = `Failed to Load ${url} Plugin: ${e.message}`;\n    });\n    return () => {\n      elRoot.innerHTML = '';\n      document.querySelectorAll('[data-plugin-res]').forEach(node => node.remove());\n    };\n  }, [url]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: styles.container,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"zc-plugin-root\",\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), !url && /*#__PURE__*/_jsxDEV(Welcome, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 16\n    }, this)]\n  }, void 0, true);\n};\n\n_s(PluginContent, \"Aoi8HvyL58l/TH6/w/HCAkolOe0=\");\n\n_c = PluginContent;\n\nvar _c;\n\n$RefreshReg$(_c, \"PluginContent\");","map":{"version":3,"sources":["/home/samuel/Documents/Zuri project/zc_main/zc_frontend/src/components/PluginContent.js"],"names":["axios","useContext","useEffect","URLContext","cheerio","styles","Welcome","PluginContent","state","url","elRoot","document","getElementById","reProtocol","oURL","URL","test","prefixLink","mimeType","ret","origin","get","toString","then","res","$","load","data","each","link","createElement","Object","keys","attribs","forEach","attr","setAttribute","href","remove","head","prepend","script","src","innerText","html","body","appendChild","innerHTML","catch","e","message","querySelectorAll","node","container"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,OAAtC;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,OAAOC,OAAP,MAAoB,SAApB;AAEA,OAAOC,MAAP,MAAmB,oCAAnB;AACA,OAAOC,OAAP,MAAoB,WAApB;;;AAEA,OAAO,MAAMC,aAAa,GAAG,MAAM;AAAA;;AACjC;AACA,QAAMC,KAAK,GAAGP,UAAU,CAACE,UAAD,CAAxB;AACA,QAAM,CAACM,GAAD,IAAQD,KAAK,CAACC,GAApB;AAGAP,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACO,GAAL,EAAU;AAEV,UAAMC,MAAM,GAAGC,QAAQ,CAACC,cAAT,CAAwB,gBAAxB,CAAf;AACA,UAAMC,UAAU,GAAG,cAAnB;AACA,UAAMC,IAAI,GAAG,IAAIC,GAAJ,CAAQF,UAAU,CAACG,IAAX,CAAgBP,GAAhB,IAAuBA,GAAvB,GAA6B,YAAYA,GAAjD,CAAb;;AACA,UAAMQ,UAAU,GAAG,CAACR,GAAD,EAAMK,IAAN,EAAYI,QAAQ,GAAG,WAAvB,KAAuC;AACxD,UAAIC,GAAG,GAAGN,UAAU,CAACG,IAAX,CAAgBP,GAAhB,IAAuBA,GAAvB,GAA8B,GAAEK,IAAI,CAACM,MAAO,GAAEX,GAAI,EAA5D;AACA,aAAQ,cAAaU,GAAI,aAAYD,QAAS,EAA9C;AACD,KAHD;;AAKAlB,IAAAA,KAAK,CACFqB,GADH,CACOJ,UAAU,CAACH,IAAI,CAACQ,QAAL,EAAD,CADjB,EAEGC,IAFH,CAESC,GAAD,IAAS;AACb,YAAMC,CAAC,GAAGrB,OAAO,CAACsB,IAAR,CAAaF,GAAG,CAACG,IAAjB,CAAV,CADa,CAGb;;AACAF,MAAAA,CAAC,CAAE,wBAAF,CAAD,CAA4BG,IAA5B,CAAiC,YAAY;AAC3C,cAAMC,IAAI,GAAGlB,QAAQ,CAACmB,aAAT,CAAuB,MAAvB,CAAb;AACAC,QAAAA,MAAM,CAACC,IAAP,CAAY,KAAKC,OAAjB,EAA0BC,OAA1B,CAAmCC,IAAD,IAChCN,IAAI,CAACO,YAAL,CAAkBD,IAAlB,EAAwB,KAAKF,OAAL,CAAaE,IAAb,CAAxB,CADF;AAGAN,QAAAA,IAAI,CAACO,YAAL,CACE,MADF,EAEEnB,UAAU,CAAC,KAAKgB,OAAL,CAAaI,IAAd,EAAoBvB,IAApB,EAA0B,UAA1B,CAFZ;AAIAe,QAAAA,IAAI,CAACO,YAAL,CAAkB,iBAAlB,EAAqC,IAArC;AACAX,QAAAA,CAAC,CAAC,IAAD,CAAD,CAAQa,MAAR;AACA3B,QAAAA,QAAQ,CAAC4B,IAAT,CAAcC,OAAd,CAAsBX,IAAtB;AACD,OAZD,EAJa,CAkBb;;AACAJ,MAAAA,CAAC,CAAC,QAAD,CAAD,CAAYG,IAAZ,CAAiB,YAAY;AAC3B,cAAMa,MAAM,GAAG9B,QAAQ,CAACmB,aAAT,CAAuB,QAAvB,CAAf;AACAC,QAAAA,MAAM,CAACC,IAAP,CAAY,KAAKC,OAAjB,EAA0BC,OAA1B,CAAmCC,IAAD,IAChCM,MAAM,CAACL,YAAP,CAAoBD,IAApB,EAA0B,KAAKF,OAAL,CAAaE,IAAb,CAA1B,CADF;;AAGA,YAAIM,MAAM,CAACC,GAAX,EAAgB;AACdD,UAAAA,MAAM,CAACL,YAAP,CACE,KADF,EAEEnB,UAAU,CAAC,KAAKgB,OAAL,CAAaS,GAAd,EAAmB5B,IAAnB,EAAyB,wBAAzB,CAFZ;AAID,SALD,MAKO;AACL2B,UAAAA,MAAM,CAACE,SAAP,GAAmBlB,CAAC,CAAC,IAAD,CAAD,CAAQmB,IAAR,EAAnB;AACD;;AACDnB,QAAAA,CAAC,CAAC,IAAD,CAAD,CAAQa,MAAR;AACAG,QAAAA,MAAM,CAACL,YAAP,CAAoB,iBAApB,EAAuC,IAAvC;AACAzB,QAAAA,QAAQ,CAACkC,IAAT,CAAcC,WAAd,CAA0BL,MAA1B;AACD,OAhBD;AAiBA/B,MAAAA,MAAM,CAACqC,SAAP,GAAmBtB,CAAC,CAAC,MAAD,CAAD,CAAUmB,IAAV,EAAnB;AACD,KAvCH,EAwCGI,KAxCH,CAwCUC,CAAD,IAAO;AACZvC,MAAAA,MAAM,CAACqC,SAAP,GAAoB,kBAAiBtC,GAAI,YAAWwC,CAAC,CAACC,OAAQ,EAA9D;AACD,KA1CH;AA2CA,WAAO,MAAM;AACXxC,MAAAA,MAAM,CAACqC,SAAP,GAAmB,EAAnB;AACApC,MAAAA,QAAQ,CACLwC,gBADH,CACoB,mBADpB,EAEGjB,OAFH,CAEYkB,IAAD,IAAUA,IAAI,CAACd,MAAL,EAFrB;AAGD,KALD;AAMD,GA5DQ,EA4DN,CAAC7B,GAAD,CA5DM,CAAT;AA8DA,sBACE;AAAA,4BACE;AAAS,MAAA,SAAS,EAAEJ,MAAM,CAACgD,SAA3B;AAAA,6BACE;AAAK,QAAA,EAAE,EAAC,gBAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,EAIG,CAAC5C,GAAD,iBAAQ,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA,YAJX;AAAA,kBADF;AAQD,CA5EM;;GAAMF,a;;KAAAA,a","sourcesContent":["import axios from 'axios'\nimport { useContext, useEffect } from 'react'\nimport { URLContext } from '../contexts/Url'\nimport cheerio from 'cheerio'\n\nimport styles from '../styles/PluginContent.module.css'\nimport Welcome from './Welcome'\n\nexport const PluginContent = () => { \n  // const pluginUrl = '/apps/default';\n  const state = useContext(URLContext)\n  const [url] = state.url\n  \n\n  useEffect(() => {\n    if (!url) return\n\n    const elRoot = document.getElementById('zc-plugin-root')\n    const reProtocol = /^https?:\\/\\//\n    const oURL = new URL(reProtocol.test(url) ? url : 'http://' + url)\n    const prefixLink = (url, oURL, mimeType = 'text/html') => {\n      let ret = reProtocol.test(url) ? url : `${oURL.origin}${url}`\n      return `/proxy?url=${ret}&mimeType=${mimeType}`\n    }\n\n    axios\n      .get(prefixLink(oURL.toString()))\n      .then((res) => {\n        const $ = cheerio.load(res.data)\n\n        // append stylesheet\n        $(`link[rel=\"stylesheet\"]`).each(function () {\n          const link = document.createElement('link')\n          Object.keys(this.attribs).forEach((attr) =>\n            link.setAttribute(attr, this.attribs[attr])\n          )\n          link.setAttribute(\n            'href',\n            prefixLink(this.attribs.href, oURL, 'text/css')\n          )\n          link.setAttribute('data-plugin-res', true)\n          $(this).remove()\n          document.head.prepend(link)\n        })\n\n        // append scripts\n        $('script').each(function () {\n          const script = document.createElement('script')\n          Object.keys(this.attribs).forEach((attr) =>\n            script.setAttribute(attr, this.attribs[attr])\n          )\n          if (script.src) {\n            script.setAttribute(\n              'src',\n              prefixLink(this.attribs.src, oURL, 'application/javascript')\n            )\n          } else {\n            script.innerText = $(this).html()\n          }\n          $(this).remove()\n          script.setAttribute('data-plugin-res', true)\n          document.body.appendChild(script)\n        })\n        elRoot.innerHTML = $('body').html()\n      })\n      .catch((e) => {\n        elRoot.innerHTML = `Failed to Load ${url} Plugin: ${e.message}`\n      })\n    return () => {\n      elRoot.innerHTML = ''\n      document\n        .querySelectorAll('[data-plugin-res]')\n        .forEach((node) => node.remove())\n    }\n  }, [url])\n\n  return (\n    <>\n      <section className={styles.container}>\n        <div id=\"zc-plugin-root\">Loading...</div>\n      </section>\n      {!url && <Welcome />}\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}